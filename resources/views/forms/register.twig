{% extends "layouts/base.twig" %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white rounded-lg shadow-md p-8">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">{{ title }}</h1>

    {% if success %}
    <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6" role="alert">
        <p>{{ success }}</p>
        {% if user %}
        <div class="mt-4 p-4 bg-white rounded border border-green-300">
            <h3 class="font-semibold mb-2">Detalles del Usuario:</h3>
            <ul class="text-sm space-y-1">
                <li><strong>ID:</strong> {{ user.id }}</li>
                <li><strong>Nombre:</strong> {{ user.name }}</li>
                <li><strong>Email:</strong> {{ user.email }}</li>
                <li><strong>Registrado:</strong> {{ user.created_at|date('d/m/Y H:i') }}</li>
            </ul>
        </div>
        {% endif %}
    </div>
    {% endif %}

    {% if errors %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6" role="alert">
        <p class="font-bold">Por favor corrige los siguientes errores:</p>
        <ul class="list-disc list-inside mt-2">
            {% for field, fieldErrors in errors %}
                {% for error in fieldErrors %}
                    <li>{{ error }}</li>
                {% endfor %}
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <form method="POST" action="/register" class="space-y-6">
        {{ csrf_input()|raw }}

        <div>
            <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                Nombre Completo <span class="text-red-500">*</span>
            </label>
            <input
                type="text"
                id="name"
                name="name"
                value="{{ old.name|default('') }}"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent {% if errors.name %}border-red-500{% endif %}"
                required
                minlength="3"
                maxlength="100"
            >
            {% if errors.name %}
                <p class="mt-1 text-sm text-red-600">{{ errors.name[0] }}</p>
            {% endif %}
        </div>

        <div>
            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                Email <span class="text-red-500">*</span>
            </label>
            <input
                type="email"
                id="email"
                name="email"
                value="{{ old.email|default('') }}"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent {% if errors.email %}border-red-500{% endif %}"
                required
            >
            {% if errors.email %}
                <p class="mt-1 text-sm text-red-600">{{ errors.email[0] }}</p>
            {% endif %}
            <p class="mt-1 text-sm text-gray-500">Asegúrate de usar un email único</p>
        </div>

        <div>
            <label for="password" class="block text-sm font-medium text-gray-700 mb-2">
                Contraseña <span class="text-red-500">*</span>
            </label>
            <input
                type="password"
                id="password"
                name="password"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent {% if errors.password %}border-red-500{% endif %}"
                required
                minlength="8"
            >
            {% if errors.password %}
                <p class="mt-1 text-sm text-red-600">{{ errors.password[0] }}</p>
            {% endif %}
            <p class="mt-1 text-sm text-gray-500">Mínimo 8 caracteres</p>
        </div>

        <div>
            <label for="password_confirmation" class="block text-sm font-medium text-gray-700 mb-2">
                Confirmar Contraseña <span class="text-red-500">*</span>
            </label>
            <input
                type="password"
                id="password_confirmation"
                name="password_confirmation"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent {% if errors.password_confirmation %}border-red-500{% endif %}"
                required
                minlength="8"
            >
            {% if errors.password_confirmation %}
                <p class="mt-1 text-sm text-red-600">{{ errors.password_confirmation[0] }}</p>
            {% endif %}
        </div>

        <div class="flex items-center justify-between">
            <button
                type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-200"
            >
                Registrarse
            </button>
            <a href="/" class="text-blue-600 hover:underline">Volver al inicio</a>
        </div>
    </form>

    <div class="mt-8 p-4 bg-gray-50 rounded-lg">
        <h3 class="font-semibold text-gray-700 mb-2">Características de Seguridad</h3>
        <ul class="text-sm text-gray-600 space-y-2">
            <li class="flex items-start">
                <svg class="w-5 h-5 text-green-500 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span><strong>Protección CSRF:</strong> Token único por sesión</span>
            </li>
            <li class="flex items-start">
                <svg class="w-5 h-5 text-green-500 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span><strong>Validación de Email:</strong> Verifica que el email sea único</span>
            </li>
            <li class="flex items-start">
                <svg class="w-5 h-5 text-green-500 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span><strong>Hash de Contraseña:</strong> PASSWORD_DEFAULT (bcrypt)</span>
            </li>
            <li class="flex items-start">
                <svg class="w-5 h-5 text-green-500 mr-2 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <span><strong>Validación Backend:</strong> Respect/Validation + reglas personalizadas</span>
            </li>
        </ul>
    </div>
</div>
{% endblock %}
