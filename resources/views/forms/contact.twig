{% extends "layouts/base.twig" %}

{% block content %}
<div class="max-w-2xl mx-auto bg-white rounded-lg shadow-md p-8">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">{{ title }}</h1>

    {% if success %}
    <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6" role="alert">
        <p>{{ success }}</p>
    </div>
    {% endif %}

    {% if errors %}
    <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6" role="alert">
        <p class="font-bold">Por favor corrige los siguientes errores:</p>
        <ul class="list-disc list-inside mt-2">
            {% for field, fieldErrors in errors %}
                {% for error in fieldErrors %}
                    <li>{{ error }}</li>
                {% endfor %}
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <form method="POST" action="/contact" class="space-y-6">
        {{ csrf_input()|raw }}

        <div>
            <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                Nombre <span class="text-red-500">*</span>
            </label>
            <input
                type="text"
                id="name"
                name="name"
                value="{{ old.name|default('') }}"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent {% if errors.name %}border-red-500{% endif %}"
                required
                minlength="3"
                maxlength="100"
            >
            {% if errors.name %}
                <p class="mt-1 text-sm text-red-600">{{ errors.name[0] }}</p>
            {% endif %}
        </div>

        <div>
            <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                Email <span class="text-red-500">*</span>
            </label>
            <input
                type="email"
                id="email"
                name="email"
                value="{{ old.email|default('') }}"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent {% if errors.email %}border-red-500{% endif %}"
                required
            >
            {% if errors.email %}
                <p class="mt-1 text-sm text-red-600">{{ errors.email[0] }}</p>
            {% endif %}
        </div>

        <div>
            <label for="subject" class="block text-sm font-medium text-gray-700 mb-2">
                Asunto <span class="text-red-500">*</span>
            </label>
            <input
                type="text"
                id="subject"
                name="subject"
                value="{{ old.subject|default('') }}"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent {% if errors.subject %}border-red-500{% endif %}"
                required
                minlength="5"
                maxlength="200"
            >
            {% if errors.subject %}
                <p class="mt-1 text-sm text-red-600">{{ errors.subject[0] }}</p>
            {% endif %}
        </div>

        <div>
            <label for="message" class="block text-sm font-medium text-gray-700 mb-2">
                Mensaje <span class="text-red-500">*</span>
            </label>
            <textarea
                id="message"
                name="message"
                rows="6"
                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent {% if errors.message %}border-red-500{% endif %}"
                required
                minlength="10"
                maxlength="1000"
            >{{ old.message|default('') }}</textarea>
            {% if errors.message %}
                <p class="mt-1 text-sm text-red-600">{{ errors.message[0] }}</p>
            {% endif %}
        </div>

        <div class="flex items-center justify-between">
            <button
                type="submit"
                class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-200"
            >
                Enviar Mensaje
            </button>
            <a href="/" class="text-blue-600 hover:underline">Volver al inicio</a>
        </div>
    </form>

    <div class="mt-8 p-4 bg-gray-50 rounded-lg">
        <h3 class="font-semibold text-gray-700 mb-2">Protección CSRF</h3>
        <p class="text-sm text-gray-600">Este formulario está protegido con CSRF tokens:</p>
        <ul class="text-sm text-gray-600 mt-2 space-y-1">
            <li><strong>Token Name:</strong> <code class="bg-gray-200 px-2 py-1 rounded">{{ csrf_token_name() }}</code></li>
            <li><strong>Token Value:</strong> <code class="bg-gray-200 px-2 py-1 rounded">{{ csrf_token_value()|slice(0, 16) }}...</code></li>
        </ul>
    </div>
</div>
{% endblock %}
